package com.example.ps4chart.ui

import androidx.compose.foundation.layout.*
import androidx.compose.material.Card
import androidx.compose.material.Divider
import androidx.compose.material.Text
import androidx.compose.runtime.Composable
import androidx.compose.ui.Modifier
import androidx.compose.ui.unit.dp
import com.example.ps4chart.model.ExploitRow

@Composable
fun ExploitCard(item: ExploitRow, translatedInfo: String?) {
    Card(modifier = Modifier
        .fillMaxWidth()
        .padding(8.dp)
    ) {
        Column(modifier = Modifier.padding(12.dp)) {
            Text(text = item.firmware)
            Spacer(modifier = Modifier.height(6.dp))
            Text(text = "Userland: ${'$'}{stripHtml(item.userland)}")
            Text(text = "Kernel: ${'$'}{item.kernel}")
            Divider(modifier = Modifier.padding(vertical = 8.dp))
            Text("Course of Action / Information:", modifier = Modifier.padding(bottom = 4.dp))
            if (!translatedInfo.isNullOrBlank()) {
                Text(text = translatedInfo)
            } else {
                Text(text = item.infoOriginal)
            }
        }
    }
}

fun stripHtml(html: String): String {
    return android.text.Html.fromHtml(html, android.text.Html.FROM_HTML_MODE_LEGACY).toString()
}
